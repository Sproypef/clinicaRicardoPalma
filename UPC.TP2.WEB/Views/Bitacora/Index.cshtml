@model UPC.TP2.WEB.ViewModels.BitacoraViewModel

@{
    ViewBag.Title = "Planes de salud - Mantenimiento - Bitácora de incidencias";
}

<h2>Planes de salud - Mantenimiento - Bitácora de incidencias</h2>
<hr/>
<h3>@ViewBag.Message</h3>
<hr />
<form action="" method="post" id="form_bitacora_index" name="form_bitacora_index">

    <div class="row">
        <div class="form-horizontal">
            <label class="control-label">PLAN DE SALUD</label> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <select class="select control-group" name="bitacora_action_select_plan" id="bitacora_action_select_plan">
                <option value="default">-- Seleccione --</option>
                <option value="-1">Todo</option>
                @foreach (var plan in Model.PLANES_DE_SALUD)
                {
                    if (ViewData["id_plan_salud"] != null && ViewData["id_plan_salud"].ToString() == plan.id_plan_salud.ToString())
                    {
                        <option selected value="@plan.id_plan_salud">@plan.nombre_plan</option>
                    }
                    else
                    {
                        <option value="@plan.id_plan_salud">@plan.nombre_plan</option>
                    }
                }
            </select>
        </div>
    </div>
    <p>
        @Html.ActionLink("Agregar bitácora", "Create", null, new { @class = "btn" })
        <a href="#bitacora_create_modal" role="button" class="btn" data-toggle="modal">Agregar incidencia</a>
    </p>
    <table id="table_bitacoras" class="display nowrap dataTable dtr-inline collapsed ">
        <thead>
            <tr>
                <th>
                    -
                </th>
                <th>
                    ITEM
                </th>
                <th>
                    TIPO
                </th>
                <th>
                    FECHA DE REGISTRO
                </th>
                <th>
                    DESCRIPCI&Oacute;N
                </th>
                <th>
                    PLAN
                </th>
                <th>
                    EMPLEADO
                </th>
                <th></th>
            </tr>
        </thead>

        @foreach (var item in Model.BITACORAS)
        {
            <tr>
                <td>
                    <a href="#bitacora_details_modal" role="button" class="btn" data-toggle="modal">Ver detalle</a>
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.id_bitacora)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.tipo_incidencia)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.fecha_registro)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.descripcion)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.T_PLAN_DE_SALUD.nombre_plan)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.T_EMPLEADO.nomEmpleado)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id=item.id_bitacora  }) |
                    @Html.ActionLink("Details", "Details", new { id = item.id_bitacora }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.id_bitacora })
                </td>
            </tr>
        }

    </table>

    <!-- CREATE -->
    <div id="bitacora_create_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Crear incidencia</h3>
        </div>
        <div class="modal-body">
            <p></p>
            <!-- content -->
            <fieldset>
                <legend>T_BITACORA_INCIDENCIA</legend>

                <div class="editor-label">
                    @Html.LabelFor(model => model.BITACORA.id_bitacora)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => model.BITACORA.id_bitacora)
                    @Html.ValidationMessageFor(model => model.BITACORA.id_bitacora)
                </div>

                <div class="editor-label">
                    @Html.LabelFor(model => model.BITACORA.tipo_incidencia)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => model.BITACORA.tipo_incidencia)
                    @Html.ValidationMessageFor(model => model.BITACORA.tipo_incidencia)
                </div>

                <div class="editor-label">
                    @Html.LabelFor(model => model.BITACORA.fecha_registro)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => model.BITACORA.fecha_registro)
                    @Html.ValidationMessageFor(model => model.BITACORA.fecha_registro)
                </div>

                <div class="editor-label">
                    @Html.LabelFor(model => model.BITACORA.descripcion)
                </div>
                <div class="editor-field">
                    @Html.EditorFor(model => model.BITACORA.descripcion)
                    @Html.ValidationMessageFor(model => model.BITACORA.descripcion)
                </div>

                <div class="editor-label">
                    @Html.LabelFor(model => model.BITACORA.id_plan_salud, "T_PLAN_DE_SALUD")
                </div>


                <p>
                    <input type="submit" value="Create" />
                </p>
            </fieldset>
        </div>
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary">Save changes</button>
        </div>
    </div>
    <!-- DETAILS -->
    <div id="bitacora_details_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Crear incidencia</h3>
        </div>
        <div class="modal-body">
            <p>One fine body…</p>
        </div>
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary">Save changes</button>
        </div>
    </div>

</form>